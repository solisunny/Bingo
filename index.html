<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Solis‚Äôs Lucky Bingo!</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
:root{
--pink:#f6c1d1;
--light:#fde6ee;
--beige:#f4efe9;
--white:#fff;
}
body{
font-family:sans-serif;
background:linear-gradient(135deg,var(--light),var(--beige));
color:#6a4b57;
text-align:center;
}
header{font-size:32px;padding:15px;font-weight:bold;}
.controls input,.controls button{
padding:8px;border-radius:10px;border:1px solid #e8a2b8;margin:4px;
}
button{background:var(--pink);cursor:pointer;}
.players{display:flex;flex-wrap:wrap;justify-content:center;gap:20px;padding:20px;}
.player{background:white;border-radius:20px;padding:10px;box-shadow:0 5px 10px rgba(0,0,0,.1);}
.card{display:grid;grid-template-columns:repeat(5,45px);gap:5px;}
.cell{
width:45px;height:45px;background:var(--beige);
display:flex;align-items:center;justify-content:center;
border-radius:6px;font-weight:bold;cursor:pointer;
}
.marked{background:var(--pink);color:white;}
.free{background:#e8a2b8;color:white;}
#called{font-size:30px;margin:10px;}
.scoreboard{margin-top:15px;}
</style>
</head>
<body>

<header>üå∏ Solis‚Äôs Lucky Bingo! üå∏</header>

<div class="controls">
<input id="name" placeholder="Your name">
<button onclick="join()">Join Game</button>
<button onclick="draw()">Draw Number</button>
<div id="called">‚Äî</div>
</div>

<div class="scoreboard" id="scoreboard"></div>
<div class="players" id="players"></div>

<!-- Sounds -->
<audio id="drawSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_2f2c9e4fa5.mp3"></audio>
<audio id="markSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_4c6f3a75aa.mp3"></audio>
<audio id="bingoSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_ee2f96fd42.mp3"></audio>

<script>
/* üî• PASTE YOUR FIREBASE CONFIG HERE */

const firebaseConfig = {
  apiKey: "AIzaSyBVrhc1D-34_CumswlcqYwjQKT1GZx26tE",
  authDomain: "bingo-91602.firebaseapp.com",
  projectId: "bingo-91602",
  storageBucket: "bingo-91602.firebasestorage.app",
  messagingSenderId: "90165648223",
  appId: "1:90165648223:web:d69d8d2fd06c6e0300b4ea",
  measurementId: "G-YZQTSR3F0B"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let myName="";

function rand(min,max){return Math.floor(Math.random()*(max-min+1))+min;}

function generateCard(){
let card=[];
let ranges=[[1,15],[16,30],[31,45],[46,60],[61,75]];
for(let c=0;c<5;c++){
let nums=[];
while(nums.length<5){
let n=rand(...ranges[c]);
if(!nums.includes(n))nums.push(n);
}
for(let r=0;r<5;r++){
if(!card[r])card[r]=[];
card[r][c]=nums[r];
}
}
card[2][2]="FREE";
return card;
}

function join(){
myName=document.getElementById("name").value.trim();
if(!myName) return alert("Enter name");

const ref=db.ref("players/"+myName);
ref.set({
card:generateCard(),
marked:Array(5).fill().map(()=>Array(5).fill(false)),
score:0
});
}

function draw(){
const ref=db.ref("state/number");
const num=rand(1,75);
ref.set(num);
document.getElementById("drawSound").play();
}

function toggle(name,r,c){
db.ref("players/"+name+"/marked/"+r+"/"+c).set(true);
document.getElementById("markSound").play();
}

function checkBingo(m){
for(let i=0;i<5;i++){
if(m[i].every(v=>v))return true;
if(m.every(r=>r[i]))return true;
}
if([0,1,2,3,4].every(i=>m[i][i]))return true;
if([0,1,2,3,4].every(i=>m[i][4-i]))return true;
return false;
}

db.ref("state/number").on("value",s=>{
if(s.exists()) document.getElementById("called").textContent=s.val();
});

db.ref("players").on("value",snap=>{
const players=snap.val()||{};
render(players);
});

function render(players){
const div=document.getElementById("players");
div.innerHTML="";
let scoreHTML="<h3>üèÜ Scoreboard</h3>";

for(const name in players){
scoreHTML+=`${name}: ${players[name].score || 0} wins<br>`;
const p=players[name];
let html=`<div class="player"><h3>${name}</h3><div class="card">`;

for(let r=0;r<5;r++){
for(let c=0;c<5;c++){
let v=p.card[r][c];
let m=p.marked[r][c];
let free=v==="FREE";
html+=`<div class="cell ${(m||free)?"marked":""} ${free?"free":""}"
onclick="toggle('${name}',${r},${c})">${v}</div>`;
}
}
html+=`</div></div>`;
div.innerHTML+=html;

if(checkBingo(p.marked)){
document.getElementById("bingoSound").play();
db.ref("players/"+name+"/score").set((p.score||0)+1);
}
}
document.getElementById("scoreboard").innerHTML=scoreHTML;
}
</script>
</body>
</html>
